<!DOCTYPE HTML>

<html>
  <head>
    <title>Minimal Sufficient Explanations for Factored Markov Decision Processes</title>
    
    
    <meta name="description" content="This website is the home of Harsha Kokel. A Ph.D. student working with Prof. Sriraam Natarajan at The University of Texas at Dallas" />
    
    <meta charset="utf-8" />
    <link rel="preconnect" href="https://fonts.gstatic.com"> 
    <link href="https://fonts.googleapis.com/css2?family=Dawning+of+a+New+Day&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="referrer" content="no-referrer">
    
    
    
    <link rel="stylesheet" href="/css/main.css" />
    
    
    
    <link rel="stylesheet" href="/css/academicons.min.css"/>
    <link rel="stylesheet" href="/css/ocs-ui.min.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
     <script src="/js/jquery-3.3.1.min.js"></script>
    <link rel="manifest" href="/site.webmanifest">
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Minimal Sufficient Explanations for Factored Markov Decision Processes"/>
<meta name="twitter:description" content="Automated planning problems have long been attempted using Markov Decision Processes (MDPs). MDPs are capable of handling the probabilistic and sequential nature of planning problem. They solve the problem by providing a policy which is a mapping from states to actions. However, to use this policy in the real-world, we first need users to trust the policy. The issue of trust can be ameliorated if the policy provides an explanation for its recommeded actions."/>

    <meta property="og:title" content="Minimal Sufficient Explanations for Factored Markov Decision Processes" />
<meta property="og:description" content="Automated planning problems have long been attempted using Markov Decision Processes (MDPs). MDPs are capable of handling the probabilistic and sequential nature of planning problem. They solve the problem by providing a policy which is a mapping from states to actions. However, to use this policy in the real-world, we first need users to trust the policy. The issue of trust can be ameliorated if the policy provides an explanation for its recommeded actions." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://harshakokel.com/posts/minimal-sufficient-explanation/" />
<meta property="article:published_time" content="2019-09-03T16:40:08+02:00" />
<meta property="article:modified_time" content="2019-09-03T16:40:08+02:00" /><meta property="og:site_name" content="Harsha Kokel" />

    <meta itemprop="name" content="Minimal Sufficient Explanations for Factored Markov Decision Processes">
<meta itemprop="description" content="Automated planning problems have long been attempted using Markov Decision Processes (MDPs). MDPs are capable of handling the probabilistic and sequential nature of planning problem. They solve the problem by providing a policy which is a mapping from states to actions. However, to use this policy in the real-world, we first need users to trust the policy. The issue of trust can be ameliorated if the policy provides an explanation for its recommeded actions.">
<meta itemprop="datePublished" content="2019-09-03T16:40:08+02:00" />
<meta itemprop="dateModified" content="2019-09-03T16:40:08+02:00" />
<meta itemprop="wordCount" content="1089">



<meta itemprop="keywords" content="planning,XAI,RL," />

    
  </head>
  <body>

    
    <div id="wrapper">

      
      <div id="main">
	<div class="inner">

	  
	  
<header id="header">
	<h3><a href="/" style="font-family: 'Dawning of a New Day', cursive;font-size:2em;color: var(--main-highlight-color);">harsha kokel</a></h3>
	<ul class="icons">
		<li id="linkedin">
			<a target="_blank" href="http://linkedin.com/in/harshakokel" title="linkedin" class="icon brands fa-linkedin">
				<span class="label" >Linked in</span>
			</a>
		</li>
		<li id="github">
			<a target="_blank" href="https://github.com/harshakokel" title="github" class="icon brands fa-github">
				<span class="label" >Github</span>
			</a>
		</li>
		<li id="email">
			<a  href="mailto:hkokel@utdallas.edu" title="mail" class="icon solid fa-envelope" >
				<span class="label" >Mail</span>
			</a>
		</li>
		<li id="twitter">
			<a target="_blank" href="https://twitter.com/harsha_kokel" title="twitter" class="icon brands fa-twitter" >
				<span class="label" title="Twitter">Twitter</span>
			</a>
		</li>
	</ul>
</header>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous" onload="renderMathInElement(document.body,{delimiters: [
  {left: '$$', right: '$$', display: true},
  {left: '$', right: '$', display: false},
  {left: '\\(', right: '\\)', display: false},
  {left: '\\[', right: '\\]', display: true}
]});"></script>




	  
<div class="page__section">
  <nav class="breadcrumb breadcrumb_type5" aria-label="Breadcrumb">
<ol  class="breadcrumb__list r-list">
  



<li class="breadcrumb__group" >
  <a href="https://harshakokel.com/" class="breadcrumb__point r-link">Home</a>
  <span class="breadcrumb__divider" aria-hidden="true">&raquo;</span>
</li>


<li class="breadcrumb__group"  class="active">
  <a href="https://harshakokel.com/posts/" class="breadcrumb__point r-link">Posts</a>
  <span class="breadcrumb__divider" aria-hidden="true">&raquo;</span>
</li>

  <li class="breadcrumb__group">
    Sep 3, 2019
  </li> 
  <li class="tags">  Tagged with:
      <a href="https://harshakokel.com/tags/planning/" class="button">planning</a>  <a href="https://harshakokel.com/tags/xai/" class="button">xai</a>  <a href="https://harshakokel.com/tags/rl/" class="button">rl</a>
  </li>
</ol> 



</nav>
</div>

  <header class="main">
    <h2>Minimal Sufficient Explanation</h2>
  </header>

  
  

  <p><strong></strong></p>
  
    <blockquote>My notes on <strong>Omar Zia Khan, Pascal Poupart, and James P Black. ICAPS 2009</strong></blockquote>
  
  <p><p>Automated planning problems have long been attempted using Markov Decision Processes (MDPs). MDPs are capable of handling the probabilistic and sequential nature of planning problem. They solve the problem by providing a policy which is a mapping from states to actions. However, to use this policy in the real-world, we first need users to trust the policy. The issue of trust can be ameliorated if the policy provides an explanation for its recommeded actions. This is the pretext of khan et al 2009.</p>
<p>Policy in MDP is usually obtained by optimizing Bellman&rsquo;s equation which considers value of a state as expected discounted total reward. This paper uses an alternate formulation of the value function introduced by  and extends it to the factored MDPs. In the alternate formulation, value function is expressed as a dot product of reward and the discounted occupancy frequencies of all the states. With this formulation, an optimal policy for a given state can explain the recommended action by simply showing that the recommended action has highest occupancy frequency of highly rewarded state(s). To this effect the paper propose three explanation templates:</p>
<ol>
<li><strong>ActionName</strong> is the only action that is likely to take you to <strong>Var1 = Val1, Var2 = Val2, &hellip;</strong> about <strong>$\lambda$</strong> times, which is higher (or lower) than any other action.</li>
<li><strong>ActionName</strong> is likely to take you to <strong>Var1 = Val1, Var2 = Val2, &hellip;</strong> about <strong>$\lambda$</strong> times, which is high (or low) as any other action''</li>
<li><strong>ActionName</strong> is likely to take you to <strong>Var1 = Val1, Var2 = Val2, &hellip;</strong> about <strong>$\lambda$</strong> times.</li>
</ol>
<p><strong>Var1 = Val1, Var2 = Val2, &hellip;</strong> in the template represents a single state (in case of MDPs) or a scenario\footnote{In the case of factored MDPs, the reward function is also factored and the scenario used is defined as set of states which have similar rewards.} (in case of Factored MDPs). Multiple templates can be used for explaining a recommended action.</p>
<p>Power of these templates can be realized if they provide minimal-sufficient explanations (MSE). An explanation is sufficient if it can prove that the action recommended is optimal (or no other action has better utility than the recommended action). Sufficient explanation is minimal if the number of templates used are minimum possible.</p>
<p>When the policy ($\pi^{\ast}$) is optimal, the value of the recommended action for state $s_0$~$\left(V^{\pi^\ast}\right.$ or $\left.Q^{\pi^\ast}(s_0, \pi^\ast(s_0))\right)$ will be higher than value of all other actions $\left(Q^{\pi^\ast}(s_0,a), ,  \forall a \neq \pi^\ast(s_0)\right)$. Khan et al. 2009 define $V_{MSE}$ (eqn.  below) which has two components: (a) expected utility from all the states(or scenarios) included in the explanation, and (b) worst case utility of all the states (or scenarios) not included in the explanation. By this definition $V_{MSE}$ cannot exceed the value of optimal action. If the explanation is minimal and sufficient, $V_{MSE}$ will be higher than the value of any other action.</p>
<p>\[
V_{MSE} = \sum_{i \leq k}\mathbb{E}[\operatorname{utility}(s_i)] + \sum_{i &gt; k} \min(\operatorname{utility}(s_i))
\]</p>
<p>\[
V^{\pi^{\star}} \geq V_{MSE} &gt; Q^{\pi^\star}(s_0,a), ,  \forall a \neq \pi^\star(s_0)
\]</p>
<p>With that definition of $V_{MSE}$, Khan et al. propose an algorithm to produce MSE at any state $s_0$ for a given optimal policy in factored MDP setting. They evaluate the MSE on two experimental domains of &ldquo;course-advising&rdquo; and &ldquo;handwashing&rdquo;. The experimental results show that the number of templates in MSE is high (or low) when the ratio of the expected utility for the optimal and the second best optimal policy is high (or low). User study with advisors in the course-advising domain show that the advisors found the explanations useful and perhaps beneficial for grade-conscious or poor performing students. User study with students show that more than 50% of the students found the explanations easy to understand, accurate and informative. However, most of them needed further information to trust the action recommended.</p>
<h2 id="critique">Critique</h2>
<p>The paper addresses a very important topic of explaining the recommendations of a Markov Decision Process. The work is especially commendable as it was done way ahead of the Explainable AI Hype. They provide a very principled and straight forward way to explain the recommendations from the perspective of how the policy is constructed. However, it might not be intuitive enough to the users. As seen in the user-study, most of the users wanted to compare the explanation of the recommended action with their preferred actions or need more information about occupancy frequencies.</p>
<p>In complex domains, Bellman&rsquo;s optimality equation is not solved exactly and hence, the value function of each state is only discovered approximately by the RL agent. In that scenario, as I understand, the optimality of the policy is only with respect to that approximate value function and hence the explanation of optimality is also only with respect to that approximate value function. To end user, this values might not mean anything and hence the sufficiency of the explanation might be questioned.</p>
<p>The explanations are only useful when it has less number of templates, the user-study in course-advising domain shown in the paper has less than 3 templates for the explanations. But in complex domain, as seen in handwashing experiments the number of templates will eventually increase and I conjecture that with increase in the number of templates the explanations will be less meaningful to the users.</p>
<p>Also, as raised by Dr. Natarajan in the class discussion the template only explains the action with respect to the states it visits but not with respect to the states it helps avoid. For domain where we want to avoid a certain states, we encode high negative rewards for that state. Even though the optimal policy learns to avoid that negative state, the MSE framework will only look at the occupancy frequency of highly rewarding states and try to explain positive reward states. As the occupancy frequency of the highly negative state is $0$ with the recommended action, it will not come up in the explanation. Although the templates proposed does mention &ldquo;or lower&rdquo; in brackets, it is not quite clear how the avoided state will be added in the explanation.</p>
<p>Finally, in RL we usually assume the policy is mapping of states to a distribution over actions. Explaining a distribution might be complex than a single action. This paper concentrates on explaining the best action out of that distribution. However, there might be two equally good actions, or there might be more than one optimal policy. One has to extend this framework for that use cases before using it in a real system.</p>
<h3 id="references">References</h3>
<ol>
<li>Pascal Poupart. 2005. Exploiting structure to efficiently solve large scalepartially observable Markov decision processes. Citeseer.</li>
</ol>
</p>



<script src="https://utteranc.es/client.js"
        repo="harshakokel/harshakokel.github.io"
        issue-number=4
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>

<div class="postpagination">
  
    <a class="postpagination__item prev" href="https://harshakokel.com/posts/advice-based-learning/">
        <span class="postpagination__label"><i class="fa solid fa-backward"></i> Previous post</span>
        <span class="postpagination__title">Advice based relational learning</span>
    </a>
  

  
    <a class="postpagination__item next" href="https://harshakokel.com/posts/active-advice-seeking/">
      <span class="postpagination__label">Next post <i class="fa solid fa-forward"></i></span>
      <span class="postpagination__title" >Active Advice Seeking for Inverse Reinforcement Learning</span>
    </a>
  
</div>
<br>



	</div>
      </div>

      
<div id="sidebar">
  <div class="inner">

    <section id="search" class="alt">
									<form method="post" action="#">
										<input type="text" name="search-by" id="search-by" type="search" placeholder="Search">
									</form>
</section>




<script type="text/javascript" src="/js/lunr.js?1609700518"></script>
<script type="text/javascript" src="/js/auto-complete.js?1609700518"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/harshakokel.com";
    
</script>
<script type="text/javascript" src="/js/search.js?1609700518"></script>

    
<nav id="menu">
  <h2>hk</h2>
  
  <ul>
    
    
    
    <li><a href="/">Homepage</a></li>
    
    
    
    <li><a href="/cv/">cv</a></li>
    
    
    
    <li><a href="/projects/">projects</a></li>
    
    
    
    <li><a href="/posts/">BLOG POSTS</a></li>
    
    
  </ul>
</nav>


    
<footer id="footer">
  <p class="copyright">Powered by <a href="https://gohugo.io">Hugo</a> and design by <a href="https://html5up.net">HTML5 UP</a>.</p>
</footer>


  </div>
</div>


    </div>
    
    
    
    <script src="/js/jquery.min.js"></script>
    <script src="/js/skel.min.js"></script>
    <script src="/js/util.js"></script>
    
    <script src="/js/main.js"></script>
    
      

  </body>
</html>
